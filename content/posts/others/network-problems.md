+++
title = 'Network Problems'
date = 2025-03-13T20:52:55+08:00
categories = ['network']
tags = ['network']
+++

# 常见网络问题排查方法及解决

在日常生活中，我们经常会遇到网络连接问题，特别是刚搬家或重新配置网络时。例如，手机可以正常连接 WiFi 上网，但电脑却无法访问任何网站。这类问题可能由多种原因导致，包括 IP 分配错误、DNS 解析失败、代理设置异常等。

本文将介绍一套系统化的网络问题排查方法，并解析每一步的底层原理，帮助你快速找出问题并高效解决。

## 1. 确认 PC 是否真的无法上网

### **排查步骤**

- **尝试 Ping 外部网络**（检查是否能访问互联网）

  ```powershell
  ping 8.8.8.8
  ```

  如果能够 ping 通，说明网络连接正常，可能是 DNS 解析问题。 如果 ping 不通，可能是 IP 配置、路由器或运营商问题。

- **尝试 Ping 路由器**（检查本地网络是否正常）

  ```powershell
  ipconfig
  ping [默认网关地址]  # 比如 192.168.1.1
  ```

  如果无法 ping 通路由器，说明 WiFi 连接可能有问题。

### **底层原因**

Ping 测试可以确认设备是否能够到达目标网络：

- **Ping 外部网络成功但无法打开网页**：可能是 DNS 解析失败。
- **Ping 路由器失败**：可能是 WiFi 连接不稳定或设备未正确获取 IP 地址。

## 2. 检查 IP 配置

### **排查步骤**

- 运行以下命令，查看 IP 地址：

  ```powershell
  ipconfig /all
  ```

- 重点检查 WiFi 适配器的 `IPv4 地址` 和 `默认网关`：

  - **如果 IP 地址是** `**169.254.x.x**`：说明 DHCP 服务器未分配 IP。
  - **如果 IP 地址是** `**192.168.x.x**` **或** `**10.x.x.x**`，说明路由器已正常分配 IP。

- 若 IP 分配异常，可尝试手动释放并重新获取 IP：

  ```powershell
  ipconfig /release
  ipconfig /renew
  ```

### **底层原因**

计算机连接 WiFi 后，会通过 DHCP（动态主机配置协议）向路由器请求 IP 地址。如果 DHCP 服务器未能正确分配 IP，设备会自动获取 `169.254.x.x` 这样的私有地址，从而无法访问外部网络。

## 3. 检查 DNS 解析

### **排查步骤**

- 运行 `nslookup` 命令测试 DNS 解析：

  ```powershell
  nslookup www.google.com
  ```

- 如果 DNS 解析失败，可以手动修改 DNS 服务器：

  1. 打开 **控制面板 > 网络和 Internet > 网络和共享中心**。
  2. 选择 WiFi 连接，点击 **属性**。
  3. 选择 **Internet 协议版本 4（TCP/IPv4）**，点击 **属性**。
  4. 选择 **使用以下 DNS 服务器地址**，填入：
     - **首选 DNS 服务器**：`8.8.8.8`
     - **备用 DNS 服务器**：`8.8.4.4`

### **底层原因**

DNS（域名系统）负责将域名（如 `www.google.com`）解析为 IP 地址。如果 DNS 服务器异常，浏览器无法解析域名，就会导致网页无法打开。

## 4. 检查代理设置

### **排查步骤**

- 在 Windows 设置中检查代理配置：
  1. 打开 **设置 > 网络和 Internet > 代理**。
  2. 确保 **自动检测设置** 开启，**手动代理** 关闭。
- 在浏览器中检查是否配置了错误的代理服务器：
  1. 在 Chrome 中访问 `chrome://settings/`。
  2. 搜索 **代理**，进入系统代理设置。
  3. 关闭代理或检查是否有异常的代理服务器。

### **底层原因**

如果启用了错误的代理服务器，所有网络请求可能会被重定向到无效的地址，导致网页无法打开。

## 5. 关闭 VPN 或防火墙

### **排查步骤**

- 如果使用了 VPN，尝试关闭 VPN 进行测试。
- 关闭 Windows Defender 或第三方防火墙，测试是否恢复正常。

### **底层原因**

VPN 可能会更改网络路由，使某些网站无法访问。防火墙可能会阻止某些应用程序的网络请求，导致浏览器无法正常访问互联网。

## 6. 重新安装 WiFi 驱动

### **排查步骤**

1. **右键** 点击 **开始菜单**，选择 **设备管理器**。
2. 展开 **网络适配器**，找到 WiFi 适配器。
3. 右键点击 WiFi 适配器，选择 **卸载设备**。
4. 重启电脑，Windows 会自动重新安装驱动。

### **底层原因**

WiFi 驱动可能因为系统更新或错误配置导致无法正常工作。重新安装驱动可以修复大多数网络适配器相关问题。

## 7. 重新连接 WiFi

### **排查步骤**

- **删除 WiFi 配置**
  1. 打开 **设置 > 网络和 Internet > WiFi**。
  2. 选择 **已知网络**，找到你的 WiFi，点击 **忘记**。
  3. 重新连接 WiFi，并输入密码。

### **底层原因**

存储的 WiFi 配置文件可能已损坏或过时，导致连接失败。删除并重新连接可以重新获取正确的网络配置。

## 8. 复位网络设置

### **排查步骤**

运行以下命令重置网络设置：

```powershell
netsh winsock reset
netsh int ip reset
ipconfig /flushdns
ipconfig /release
ipconfig /renew
```

然后重启电脑。

### **底层原因**

Windows 网络堆栈可能因错误设置或系统问题导致异常。重置网络可以恢复默认配置，解决大多数网络故障。